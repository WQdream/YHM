import{p as oe}from"./print-DE5qJvB1.js";import{a8 as ne,a7 as le,d as q,r as ie,u as re,s as se,a as ce,y as D,c as g,$ as de,e as c,f as N,w as pe,H as S,k as x,j as d,G as I,V as j,W as H,B as he,i as M,t as G,R as ue,g as O,E as me,m as ge,p as fe,q as xe}from"./index-DFEDjKuf.js";import{S as be}from"./sortable.esm-BS5toX6s.js";import{_ as ye}from"./plugin-vueexport-helper-DlAUqK2U.js";var J={exports:{}};/*!
 * js-table2excel v1.1.2
 * Released under the MIT License.
 * repository: https://github.com/hxj9102/table2excel.git
 */(function(l,P){(function(W,n){l.exports=n()})(ne,function(){var W=function(f,b){var r;((r=window.navigator.userAgent).indexOf("MSIE")>=0?"ie":r.indexOf("Firefox")>=0?"Firefox":r.indexOf("Chrome")>=0?"Chrome":r.indexOf("Opera")>=0?"Opera":r.indexOf("Safari")>=0?"Safari":void 0)=="ie"?n(f):v(f,b)},n=function(f,b){var r=f,e=new ActiveXObject("Excel.Application"),p=e.Workbooks.Add(),h=p.Worksheets(1),y=document.body.createTextRange();y.moveToElementText(r),y.select,y.execCommand("Copy"),h.Paste(),e.Visible=!0;try{e.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(E){print("Nested catch caught "+E)}finally{p.SaveAs(fname),p.Close(savechanges=!1),e.Quit(),e=null,window.setInterval("Cleanup();",1),window.setInterval("Cleanup();",1)}},v=function(f,b){var r,e="data:application/vnd.ms-excel;base64,"+function(y){return window.btoa(unescape(encodeURIComponent(y)))}((r={worksheet:b,table:f},'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g,function(y,E){return r[E]})));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=e;else{var p,h=document.createElement("a");h.href=e,h.download=b||"",window.MouseEvent?p=new MouseEvent("click"):(p=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),h.dispatchEvent(p)}};return function(){for(var f={image:function(i,s){return s=Object.assign({width:40,height:60},s),'<td style="width: '.concat(s.width,"px; height: ").concat(s.height,'px; text-align: center; vertical-align: middle"><img src="').concat(i,'" width=').concat(.99*s.width," height=").concat(.99*s.height," /></td>")},text:function(i){return'<td style="text-align: center">'.concat(i,"</td>")}},b=arguments.length,r=new Array(b),e=0;e<b;e++)r[e]=arguments[e];var p=function(i){return i.length===1?i[0]:{column:i[0]||[],data:i[1]||[],excelName:i[2]||"",captionName:i[3]}}(r),h=p.column,y=p.data,E=p.excelName,L=p.captionName,U=L?'<caption style="font-weight:bold">'.concat(L,"</caption>"):"",T=h.reduce(function(i,s){return i+="<th>".concat(s.title,"</th>")},"");T="<thead><tr>".concat(T,"</tr></thead>");var A=y.reduce(function(i,s){var B=h.reduce(function(F,k){var z={};return k.type==="image"&&(s.size?(z.width=s.size[0],z.height=s.size[1]):(k.width&&(z.width=k.width),k.height&&(z.height=k.height))),F+=f[k.type||"text"](s[k.key],z)},"");return i+="<tr>".concat(B,"</tr>")},"");A="<tbody>".concat(A,"</tbody>"),W(U+T+A,E)}})})(J);var ke=J.exports;const we=le(ke),ve=l=>(fe("data-v-e4c3f7b6"),l=l(),xe(),l),Ce={class:"table-container"},_e={class:"table-footer mt15"},Se={class:"table-footer-tool"},Ee={class:"tool-box"},ze=["data-key"],Ne=ve(()=>O("i",{class:"fa fa-arrows-alt handle cursor-pointer"},null,-1)),Te=q({name:"netxTable"}),Ae=q({...Te,props:{data:{type:Array,default:()=>[]},header:{type:Array,default:()=>[]},ontab:{type:Array,default:()=>[]},ontabWidth:{type:Number,default:()=>200},config:{type:Object,default:()=>{}},printName:{type:String,default:()=>""}},emits:["delRow","pageChange","sortHeader"],setup(l,{expose:P,emit:W}){const n=l,v=W,f=ie(),b=re(),{themeConfig:r}=se(b),e=ce({page:{pageNum:1,pageSize:10},selectlist:[],checkListAll:!0,checkListIndeterminate:!1}),p=D(()=>!!n.config.isBorder),h=D(()=>n.config),y=D(()=>n.header.filter(o=>o.isCheck)),E=o=>{o?n.header.forEach(a=>a.isCheck=!0):n.header.forEach(a=>a.isCheck=!1),e.checkListIndeterminate=!1},L=()=>{const o=n.header.filter(a=>a.isCheck).length;e.checkListAll=o===n.header.length,e.checkListIndeterminate=o>0&&o<n.header.length},U=o=>{e.selectlist=o},T=(o,a)=>{v(o,a)},A=o=>{e.page.pageSize=o,v("pageChange",e.page)},i=o=>{e.page.pageNum=o,v("pageChange",e.page)},s=()=>{e.page.pageNum=1,e.page.pageSize=10,v("pageChange",e.page)},B=()=>{let o="",a="",u={};n.header.forEach(w=>{o+=`<th class="table-th">${w.title}</th>`}),n.data.forEach((w,C)=>{u[C]||(u[C]=[]),n.header.forEach(_=>{_.type==="text"?u[C].push(`<td class="table-th table-center">${w[_.key]}</td>`):_.type==="image"&&u[C].push(`<td class="table-th table-center"><img src="${w[_.key]}" style="width:${_.width}px;height:${_.height}px;"/></td>`)}),a+=`<tr>${u[C].join("")}</tr>`}),oe({printable:`<div style=display:flex;flex-direction:column;text-align:center><h3>${n.printName}</h3></div><table border=1 cellspacing=0><tr>${o}${a}</table>`,type:"raw-html",css:["//at.alicdn.com/t/c/font_2298093_rnp72ifj3ba.css","//unpkg.com/element-plus/dist/index.css"],style:"@media print{.mb15{margin-bottom:15px;}.el-button--small i.iconfont{font-size: 12px !important;margin-right: 5px;}}; .table-th{word-break: break-all;white-space: pre-wrap;}.table-center{text-align: center;}"})},F=()=>{if(e.selectlist.length<=0)return me.warning("请先选择要导出的数据");we(n.header,e.selectlist,`${r.value.globalTitle} ${new Date().toLocaleString()}`)},k=()=>{v("pageChange",e.page)},z=()=>{ge(()=>{const o=be.create(f.value,{handle:".handle",dataIdAttr:"data-key",animation:150,onEnd:()=>{const a=[];o.toArray().forEach(u=>{n.header.forEach(w=>{w.key===u&&a.push({...w})})}),v("sortHeader",a)}})})};return P({pageReset:s}),(o,a)=>{const u=g("el-table-column"),w=g("el-image"),C=g("el-button"),_=g("el-popconfirm"),Q=g("el-empty"),X=g("el-table"),K=g("el-pagination"),V=g("SvgIcon"),Y=g("el-tooltip"),R=g("el-checkbox"),Z=g("el-scrollbar"),ee=g("el-popover"),te=de("loading");return c(),N("div",Ce,[pe((c(),S(X,ue({data:l.data,border:p.value},o.$attrs,{"row-key":"id",stripe:"",style:{width:"100%"},onSelectionChange:U}),{empty:x(()=>[d(Q,{description:"暂无数据"})]),default:x(()=>[l.config.isSelection?(c(),S(u,{key:0,type:"selection","reserve-selection":!0,width:"30"})):I("",!0),l.config.isSerialNo?(c(),S(u,{key:1,type:"index",label:"序号",width:"60"})):I("",!0),(c(!0),N(j,null,H(y.value,(t,m)=>(c(),S(u,{key:m,"show-overflow-tooltip":"",prop:t.key,width:t.colWidth,label:t.title},{default:x($=>[t.type==="image"?(c(),S(w,{key:0,style:he({width:`${t.width}px`,height:`${t.height}px`}),src:$.row[t.key],"zoom-rate":1.2,"preview-src-list":[$.row[t.key]],"preview-teleported":"",fit:"cover"},null,8,["style","src","preview-src-list"])):(c(),N(j,{key:1},[M(G($.row[t.key]),1)],64))]),_:2},1032,["prop","width","label"]))),128)),l.config.isOperate?(c(),S(u,{key:2,label:"操作",width:l.ontabWidth},{default:x(t=>[(c(!0),N(j,null,H(l.ontab,(m,$)=>(c(),N("span",{key:$,style:{"margin-right":"15px"}},[m.name=="删除"?(c(),S(_,{key:0,title:"确定删除吗？",onConfirm:ae=>T(m.method,t.row)},{reference:x(()=>[d(C,{type:m.type,size:"mini"},{default:x(()=>[M(G(m.name),1)]),_:2},1032,["type"])]),_:2},1032,["onConfirm"])):I("",!0),m.name!=="删除"?(c(),S(C,{key:1,type:m.type,size:"mini",onClick:ae=>T(m.method,t.row)},{default:x(()=>[M(G(m.name),1)]),_:2},1032,["type","onClick"])):I("",!0)]))),128))]),_:1},8,["width"])):I("",!0)]),_:1},16,["data","border"])),[[te,l.config.loading]]),O("div",_e,[d(K,{"current-page":e.page.pageNum,"onUpdate:currentPage":a[0]||(a[0]=t=>e.page.pageNum=t),"page-size":e.page.pageSize,"onUpdate:pageSize":a[1]||(a[1]=t=>e.page.pageSize=t),"pager-count":5,"page-sizes":[10,20,30],total:l.config.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:A,onCurrentChange:i},null,8,["current-page","page-size","total"]),O("div",Se,[d(V,{name:"iconfont icon-dayin",size:19,title:"打印",onClick:B}),d(V,{name:"iconfont icon-yunxiazai_o",size:22,title:"导出",onClick:F}),d(V,{name:"iconfont icon-shuaxin",size:22,title:"刷新",onClick:k}),d(ee,{placement:"top-end",trigger:"click",transition:"el-zoom-in-top","popper-class":"table-tool-popper",width:300,persistent:!1,onShow:z},{reference:x(()=>[d(V,{name:"iconfont icon-quanjushezhi_o",size:22,title:"设置"})]),default:x(()=>[O("div",Ee,[d(Y,{content:"拖动进行排序",placement:"top-start"},{default:x(()=>[d(V,{name:"fa fa-question-circle-o",size:17,class:"ml11",color:"#909399"})]),_:1}),d(R,{modelValue:e.checkListAll,"onUpdate:modelValue":a[2]||(a[2]=t=>e.checkListAll=t),indeterminate:e.checkListIndeterminate,class:"ml10 mr1",label:"列显示",onChange:E},null,8,["modelValue","indeterminate"]),d(R,{modelValue:h.value.isSerialNo,"onUpdate:modelValue":a[3]||(a[3]=t=>h.value.isSerialNo=t),class:"ml12 mr1",label:"序号"},null,8,["modelValue"]),d(R,{modelValue:h.value.isSelection,"onUpdate:modelValue":a[4]||(a[4]=t=>h.value.isSelection=t),class:"ml12 mr1",label:"多选"},null,8,["modelValue"])]),d(Z,null,{default:x(()=>[O("div",{ref_key:"toolSetRef",ref:f,class:"tool-sortable"},[(c(!0),N(j,null,H(l.header,t=>(c(),N("div",{class:"tool-sortable-item",key:t.key,"data-key":t.key},[Ne,d(R,{modelValue:t.isCheck,"onUpdate:modelValue":m=>t.isCheck=m,size:"default",class:"ml12 mr8",label:t.title,onChange:L},null,8,["modelValue","onUpdate:modelValue","label"])],8,ze))),128))],512)]),_:1})]),_:1})])])])}}}),We=ye(Ae,[["__scopeId","data-v-e4c3f7b6"]]);export{We as default};
